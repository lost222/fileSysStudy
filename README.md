# fileSysStudy

## 最新进展记录
之前卡在 filebench不正常工作, 现在经过在买的服务器上的测试, 确定了Ubuntu 18.04x下filebench会卡死, 具体原因不明, 降到Ubuntu 16.04 就可以运行了.
> 题外话: 最近 shadowsocks老是不稳定给我带来一些麻烦.google了一下. 决定换一家服务器提供商. 此外,百项论文的写作是最近耽搁的主要原因.
## 新目标
迅速做出第一版的结果. 比对论文, 思考filebench的测试文件自己写的怎么样. 尝试写邮件向论文作者要一下.f文件, 毕竟看表格和具体到.f文件中间还有一些信息论文里没给.


# 整个过程







## 虚拟机软件

文章里没有明确说使用的虚拟机软件， 一开始也考虑过 VMWare， 但是原文说的是创建一个img文件作为虚拟机的磁盘， VMWare的磁盘由多个文件组成， 之后对于文件分区， 还有磁盘的cache模式（原文是使用Write-through) 都不是很好设置， 所以我最后 采用了 WebVirtMgr， 这个基本是用一个网页端管理KVM。 跟着教程走没遇到什么大问题



## 磁盘分区

我需要将宿主机和虚拟机的磁盘都分成多个区域， 方便以不同文件系统格式化不同分区，这是我卡了最长时间的地方。 原因是我搜索到的分区教程都是教你怎么在安装好， 系统起来以后分区，但是我我跟着教程走每次分区完成 grub就找不到操作系统了。 卡了很长时间， 到昨天晚上才意识到解决方法是在安装的时候不能按照默认的方式安装， 默认方式安装会把整个硬盘格式化成一个分区， 然后当我尝试对这个情况分区的时候问题就出现了。这个事情在昨天中午完全搞定了。 



## filebench

filebench的安装使用本来不应该是太大问题， 我之前在我的阿里云服务器上尝试过安装使用了， 一切正常， 现在的问题是我在我自己电脑的虚拟机上安装的时候， 安装成功了， 但是运行不起来， 可以正常创建文件， 分配线程， 但是之后就会报错， 信息

Unexpected Process termination code 3, Errno 0 around line 77

77行是 run 60

意思是开始运行。 运行60秒。我觉得这里怎么也不应该有问题

我google了最这个信息， 只找到filebench项目一个2017年提交的bug， 但是没有解决方法。

现在卡在这里。 我打算至少重新安装一遍 filebench， 但是装的时候不知道装去哪里了， 现在apt remove 不行

整个重新安装虚拟机但是没用







## 流程

1. 安装并分区宿主机， 设置分区 文件系统

2. 在宿主机对应分区上创建 .img 文件， 文件格式是qcow2， disk cache模式选择 write-through

   ​	这里问题是 文章里没有明确指定qcow2， 他在 related work一节中谈到不同文件格式的性能不同， 但是最后没有明确说明自己使用的是什么

3. 安装分区虚拟机 

4. 在虚拟机上安装 filebench

5. 按照论文表格， 设置相应的 benchmark.f

6. 比较throughput结果
